<Window x:Class="Plmeco.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PLMECO Transporte" Height="800" Width="1400">

    <DockPanel>

        <!-- ===== Barra de botones superior ===== -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
            <StackPanel.Resources>
                <Style TargetType="Button">
                    <Setter Property="Margin" Value="0,0,6,0"/>
                </Style>
            </StackPanel.Resources>

            <Button Content="Nueva pestaña desde Excel..." Click="NuevaPestanaDesdeExcel_Click"/>
            <Button Content="Importar en pestaña actual..." Click="ImportarEnActual_Click"/>
            <Button Content="Guardar (pestaña)" Click="Guardar_Click"/>
            <Button Content="Guardar como... (pestaña)" Click="GuardarComo_Click"/>
            <Button Content="Cerrar pestaña" Click="CerrarPestanaActual_Click"/>
        </StackPanel>

        <!-- ===== Control de pestañas ===== -->
        <TabControl x:Name="TabControlDocs"
            ItemsSource="{Binding Documents}"
            SelectedIndex="{Binding SelectedIndex, Mode=TwoWay}">
    …
        </TabControl>
        <TabControl x:Name="MainTabControl">
            <TabItem Header="Hoja 1">
                <Grid>
                    <DataGrid x:Name="TransportesDataGrid"
                              AutoGenerateColumns="False"
                              HeadersVisibility="Column"
                              CanUserAddRows="True"
                              CanUserDeleteRows="True"
                              Margin="5"
                              FontWeight="Bold"
                              FontSize="13"
                              SelectionUnit="CellOrRowHeader">

                        <!-- Estilos generales -->
                        <DataGrid.Resources>
                            <!-- Texto negro y negrita en todo el grid -->
                            <Style TargetType="DataGridCell">
                                <Setter Property="Foreground" Value="Black"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                                <!-- Color de fondo cuando está seleccionado -->
                                <Setter Property="Background" Value="LightBlue"/>
                            </Style>
                        </DataGrid.Resources>

                        <!-- Columnas -->
                        <DataGrid.Columns>

                            <!-- ESTADO con ComboBox -->
                            <DataGridComboBoxColumn Header="Estado" SelectedItemBinding="{Binding Estado, Mode=TwoWay}">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="IsHitTestVisible" Value="False"/>
                                        <Setter Property="Focusable" Value="False"/>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="ItemsSource" Value="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.EstadosDisponibles}"/>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <!-- NUEVA COLUMNA PRECINTO -->
                            <DataGridTextColumn Header="Precinto" Binding="{Binding Precinto, Mode=TwoWay}" Width="100"/>

                            <!-- LLEGADA REAL -->
                            <DataGridTextColumn Header="Llegada Real" Binding="{Binding LlegadaReal, Mode=TwoWay, StringFormat=HH:mm}" Width="100"/>

                            <!-- SALIDA REAL -->
                            <DataGridTextColumn Header="Salida Real" Binding="{Binding SalidaReal, Mode=TwoWay, StringFormat=HH:mm}" Width="100"/>

                            <!-- LEX -->
                            <DataGridCheckBoxColumn Header="LEX" Binding="{Binding LEX, Mode=TwoWay}" Width="70"/>

                            <!-- INCIDENCIAS -->
                            <DataGridTextColumn Header="Incidencias" Binding="{Binding Incidencias, Mode=TwoWay}" Width="200"/>

                            <!-- OTRAS COLUMNAS DE EJEMPLO -->
                            <DataGridTextColumn Header="Destino" Binding="{Binding Destino, Mode=TwoWay}" Width="150"/>
                            <DataGridTextColumn Header="Salida Tope" Binding="{Binding SalidaTope, Mode=TwoWay, StringFormat=HH:mm}" Width="100"/>

                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>

    </DockPanel>
</Window>
